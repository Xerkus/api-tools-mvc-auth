#!/usr/bin/env php
<?php

/**
 * @see       https://github.com/laminas-api-tools/api-tools-mvc-auth for the canonical source repository
 * @copyright https://github.com/laminas-api-tools/api-tools-mvc-auth/blob/master/COPYRIGHT.md
 * @license   https://github.com/laminas-api-tools/api-tools-mvc-auth/blob/master/LICENSE.md New BSD License
 */

if (! file_exists('./config/autoload') || ! is_dir('./config/autoload')) {
    print("You do not appear to be running this from within a Laminas/Laminas API Tools application; aborting.\n");
    exit(1);
}

$configFile = './config/autoload/api-tools-mvc-auth-oauth2-override.global.php';

$config =<<<'EOC'
<?php

/**
 * This file was autogenerated by laminas-api-tools/api-tools-mvc-auth (bin/api-tools-mvc-auth-oauth2-override.php),
 * and overrides the Laminas\ApiTools\OAuth2\Service\OAuth2Server to provide the ability to create named
 * OAuth2\Server instances.
 */
return array(
    'service_manager' => array(
        'factories' => array(
            'Laminas\ApiTools\OAuth2\Service\OAuth2Server' => 'Laminas\ApiTools\MvcAuth\Factory\NamedOAuth2ServerFactory',
        ),
    ),
);
EOC;

file_put_contents($configFile, $config);

printf("Wrote OAuth2 server override configuration to %s\n", $configFile);
exit(0);
